// @ts-nocheck
document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("poll-form"),t=document.getElementById("poll-results"),n="http://127.0.0.1:5000";async function o(){try{const e=await fetch(`${n}/votes`);if(!e.ok)throw new Error(`Failed to fetch votes: ${e.statusText}`);return await e.json()}catch(e){return console.error("Error fetching votes:",e),{speed:0,design:0,visibility:0}}}function i(e){const t=e.speed+e.design+e.visibility;if(0===t)return;const n={speed:Math.round(e.speed/t*100),design:Math.round(e.design/t*100),visibility:Math.round(e.visibility/t*100)},o=Math.max(n.speed,n.design,n.visibility),i={speed:document.getElementById("speed-bar"),design:document.getElementById("design-bar"),visibility:document.getElementById("visibility-bar")},s={speed:document.getElementById("speed-percentage"),design:document.getElementById("design-percentage"),visibility:document.getElementById("visibility-percentage")};Object.keys(i).forEach((e=>{i[e].style.width=`${n[e]}%`,i[e].style.backgroundColor=n[e]===o?"#4caf50":"#f44336",s[e].textContent=`${n[e]}%`}))}e.addEventListener("submit",(async function(t){t.preventDefault(),console.log("Vote button clicked!");const s=new FormData(e).get("vote");if(s){console.log("Submitting vote for:",s),await async function(e){try{const t=await fetch(`${n}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({option:e})});if(!t.ok)throw new Error(`Failed to submit vote: ${t.statusText}`);console.log("Vote submitted successfully")}catch(e){console.error("Error submitting vote:",e),alert("An error occurred while submitting your vote. Please try again.")}}(s),e.style.display="none";i(await o())}else console.log("No vote selected."),alert("Please select an option before voting.")})),async function(){i(await o()),t.style.display="block"}()}));