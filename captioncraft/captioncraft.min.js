// @ts-nocheck
document.addEventListener("DOMContentLoaded",(()=>{const e=(e,t=document)=>t.querySelector(e),t=document.querySelector("form"),o=e("#results"),n=e("#platform"),s=e("#format"),a=e("#formatHint"),r=e("#clearBtn"),i={facebook:["Post","Story","Reel"],instagram:["Post","Story","Reel"],twitter:["Post"],linkedin:["Profile","Page"],gmb:["Post"],tiktok:["Video"],ytshorts:["Short"],youtube:["Video"]},l={"facebook:post":"1â€“3 short paragraphs â€¢ 4â€“7 hashtags","facebook:story":"2â€“3 lines â€¢ no hashtags â€¢ link sticker","facebook:reel":"Hook + 1â€“2 lines â€¢ 3â€“5 hashtags","instagram:post":"Hook + 2â€“3 lines â€¢ 5â€“9 hashtags","instagram:story":"Very short â€¢ no hashtag soup â€¢ link sticker","instagram:reel":"Hook + benefit + CTA â€¢ 3â€“7 hashtags","twitter:post":"<280 chars â€¢ â‰¤2 hashtags","linkedin:profile":"3â€“6 lines â€¢ business tone â€¢ â‰¤3 hashtags","linkedin:page":"Brand voice â€¢ â‰¤3 hashtags","gmb:post":"Plain, local keywords â€¢ no hashtags","tiktok:video":"Hook + 2 lines + CTA â€¢ 6â€“10 hashtags","ytshorts:short":"2â€“3 lines â€¢ 3â€“5 hashtags","youtube:video":"Title + description â€¢ no hashtag soup"};function c(){const e=(n?.value||"Facebook").toLowerCase(),t=i[e]||["Post"];s&&(s.innerHTML="",t.forEach((e=>{const t=document.createElement("option");t.textContent=e,s.appendChild(t)}))),u()}function u(){if(!a)return;const e=`${(n?.value||"Facebook").toLowerCase()}:${(s?.value||"Post").toLowerCase()}`;a.textContent=l[e]||""}n?.addEventListener("change",c),s?.addEventListener("change",u),c();const d=e=>e.toString().trim().replace(/\s+/g," ").replace(/(^\w)|([.!?]\s+\w)/g,(e=>e.toUpperCase())),m=e=>/[.!?]$/.test(e.trim())?e.trim():e.trim()+".",h=(e,t)=>e.length<=t?e:e.slice(0,t-1).trim()+"â€¦",p=e=>e[Math.floor(Math.random()*e.length)],g=e=>/(https?:\/\/[^\s)]+)|(www\.[^\s)]+)/i.test(e),f=e=>e.trim().startsWith("#"),y=e=>/^title:/i.test(e.trim()),b=/(https?:\/\/[^\s)]+)|(www\.[^\s)]+)/i,v=/(https?:\/\/[^\s)]+)|(www\.[^\s)]+)/gi;function $(e,t="standard",o=!0,n="default",s="post"){const a=(n||"").toLowerCase(),r=(s||"").toLowerCase();if("gmb"===a||"youtube"===a||"story"===r)return"";let i=(e||"").split(",").map((e=>e.trim())).filter(Boolean);o&&(i=i.map((e=>e.toLowerCase().replace(/[^a-z0-9]+/g,""))),i=[...new Set(i)]);let l=5;return"instagram"===a||"facebook"===a?l="reel"===r?7:"heavy"===t?10:"light"===t?4:7:"twitter"===a?l="heavy"===t?3:2:"linkedin"===a?l="heavy"===t?5:"light"===t?2:3:"tiktok"===a?l="heavy"===t?15:"light"===t?6:10:"ytshorts"===a&&(l="heavy"===t?7:"light"===t?3:5),i=i.slice(0,l).map((e=>e.startsWith("#")?e:`#${e}`)),i.join(" ")}const k=/(?:get|have|be|is|are|was|were|do|make|build|grow|find|fix|help|win|drive|boost|book|buy|claim|start|learn|see|save|earn|bring|keep|write|post|plan|schedule|recap)/i;function w(e){if(f(e)||g(e)||y(e))return e.trim();let t=e.replace(/\s{2,}/g," ").replace(/\.{4,}/g,"â€¦").trim();return t=t.replace(/\b(\w+)\s+\1\b/gi,"$1"),t.length>0&&(t=t[0].toUpperCase()+t.slice(1)),t}function C(e){const t=e.trim();if(!t)return!1;if(f(t)||g(t)||y(t))return!1;const o=t.length<25&&!/[!?]$/.test(t),n=!k.test(t);return o||n}const L=["ğŸš€","ğŸ¯","âœ¨","ğŸ“£","âš¡","ğŸ’¡","ğŸ”¥","âœ…","ğŸ“ˆ"],x=/([\u231A-\uD83E\uDDFF\u2600-\u27BF]|\uFE0F)/g;function S(e){return(e.match(x)||[]).filter(Boolean)}function B(e){const t=e.split(/\n+/).filter((e=>e.trim().length)),o=S(e),n=o.filter((e=>L.includes(e))).length,s=t.length&&t.every((e=>{const t=e.trim();return!(t&&!f(t)&&!y(t))||function(e){const t=e.trim();return!(!t||!x.test(t[0]))}(t)})),a=t.some((e=>{const t=e.trim();if(!t||f(t)||y(t))return!1;const o=S(t);return o.length>=2&&o[0]===o[o.length-1]}));return{total:o.length,genericCount:n,frontLoaded:s,bookended:a,looksAIish:n>=2||s&&o.length>=1||a}}function I(e,t,o){const n=(e||"").toLowerCase(),s=(t||"").toLowerCase(),a=(o||"").toLowerCase(),r=[];return/(fantasy|espn|league|commish|commissioner)/.test(n+s)&&r.push("ğŸˆ","ğŸ˜‚","ğŸ™ï¸","ğŸ“£"),(n.includes("web")||n.includes("design"))&&r.push("ğŸ–¥ï¸","ğŸ¨","ğŸ› ï¸","ğŸ§©"),(n.includes("marketing")||n.includes("growth"))&&r.push("ğŸ“ˆ","ğŸ“Š","ğŸ§²","ğŸ“Œ"),(n.includes("local")||s.includes("local"))&&r.push("ğŸ“","ğŸ˜ï¸","ğŸ›£ï¸"),(s.includes("owners")||s.includes("small"))&&r.push("ğŸª","ğŸ§‘â€ğŸ’¼","ğŸ§¾"),n.includes("health")&&r.push("ğŸ©º","ğŸ¥"),(n.includes("pet")||s.includes("pet"))&&r.push("ğŸ¾","ğŸ¶","ğŸ±"),(n.includes("food")||n.includes("cafe"))&&r.push("â˜•","ğŸ”","ğŸ¥—"),"tiktok"===a&&r.push("ğŸ¬","ğŸµ"),"instagram"===a&&r.push("ğŸ“¸"),0===r.length&&r.push("ğŸ“Œ","ğŸ§­","ğŸ¤"),[...new Set(r)].slice(0,6)}function _(e,t,o,n,s,a){const r=e.result_verbs;if("community"===a){const a=e.pains,i=e.benefits_social,l=e.benefits_time;return t%3==0?{pain:o||`No time to keep your group lively: ${a[0]}.`,benefit:`With ${s}, ${l[t%l.length]}.`,result:`${r[t%r.length]}: ${n||i[(t+1)%i.length]}.`}:t%3==1?{pain:o||`Itâ€™s easy to burn out: ${a[1]}.`,benefit:`We handle the words so you donâ€™t have toâ€”${i[t%i.length]}.`,result:`${r[t%r.length]}: ${n||i[(t+1)%i.length]}.`}:{pain:o||`Keeping momentum is hard: ${a[2]}.`,benefit:`${s} means ${i[t%i.length]}.`,result:`${r[t%r.length]}: ${n||l[(t+1)%l.length]}.`}}if("authority"===a){const a=e.pains,i=e.benefits_status,l=e.benefits_time;return t%3==0?{pain:o||`Credibility slips when content lags: ${a[0]}.`,benefit:`With ${s}, you show up reliably and on-message.`,result:`${r[t%r.length]}: ${n||i[(t+1)%i.length]}.`}:t%3==1?{pain:o||`Consistency is a heavy lift: ${a[1]}.`,benefit:`${s} cuts the lift so your expertise stays front and center.`,result:`${r[t%r.length]}: ${n||l[(t+1)%l.length]}.`}:{pain:o||`The jobâ€™s bigger than it looks: ${a[2]}.`,benefit:`${s} helps you communicate like a trusted voice.`,result:`${r[t%r.length]}: ${n||i[(t+1)%i.length]}.`}}const i=e.pains,l=e.benefits_time,c=e.benefits_social;return t%3==0?{pain:o||`Itâ€™s tough when people canâ€™t find you: ${i[0]}.`,benefit:`With ${s}, you save hours and stay visible.`,result:`${r[t%r.length]}: ${n||"more inquiries without the scramble"}.`}:t%3==1?{pain:o||`Content eats your time: ${i[1]}.`,benefit:`${s} handles the heavy liftingâ€”${l[t%l.length]}.`,result:`${r[t%r.length]}: ${n||c[(t+1)%c.length]}.`}:{pain:o||`Ideas run out mid-week: ${i[2]}.`,benefit:`${s} keeps you shipping, stress-free.`,result:`${r[t%r.length]}: ${n||"consistent posts that sound human"}.`}}const E="cc_onboarding_personas",M="cc_writer_persona_selected",j="cc_mascot_name";function P(){try{return JSON.parse(localStorage.getItem(E)||"[]")}catch{return[]}}function T(){return localStorage.getItem(M)||"brand"}function H(){return localStorage.getItem(j)||""}function N(){const e=P(),t=document.getElementById("writerPersonaGroup"),o=document.getElementById("writerPersona"),n=document.getElementById("mascotNameGroup"),s=document.getElementById("mascotName");if(t&&o)if(!e||e.length<=1)t.style.display="none";else{t.style.display="",o.innerHTML="",e.forEach((e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.label||e.id,o.appendChild(t)})),o.value=T();const a=e.some((e=>"mascot"===e.id)),r=o.value;if(n&&(n.style.display=a&&"mascot"===r?"":"none"),s&&a){const t=e.find((e=>"mascot"===e.id&&e.name))?.name;s.value=t||H()||"",s.addEventListener("input",(()=>{return e=s.value,void localStorage.setItem(j,(e||"").trim());var e}))}o.addEventListener("change",(()=>{var e;e=o.value,localStorage.setItem(M,e),n&&(n.style.display="mascot"===o.value?"":"none")}))}}function A(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function D(){try{return JSON.parse(localStorage.getItem("dcc_usage")||"{}")}catch{return{}}}function W(){const e=A(),t=D();var o;return t[e]=(t[e]||0)+1,o=t,localStorage.setItem("dcc_usage",JSON.stringify(o)),t[e]}function q(){return D()[A()]||0}function F(){return"1"===(e="pro",new URLSearchParams(location.search).get(e))||("1"===localStorage.getItem("dcc_pro")||!!localStorage.getItem("dcc_pro_email"));var e}!function(){if(!localStorage.getItem(E)){const e=[{id:"brand",label:"My Brand (we/us)"}];localStorage.setItem(E,JSON.stringify(e)),localStorage.setItem(M,"brand")}}(),window.CaptionCraft=window.CaptionCraft||{},window.CaptionCraft.saveOnboardingPersonas=function(e){try{if(!Array.isArray(e)||0===e.length)return;localStorage.setItem(E,JSON.stringify(e));const t=localStorage.getItem(M),o=new Set(e.map((e=>e.id)));t&&o.has(t)||localStorage.setItem(M,e[0].id);const n=e.find((e=>"mascot"===e.id&&e.name));n&&n.name&&localStorage.setItem(j,n.name),N()}catch(e){}},N();const O=e("#upgradeModal");function z(){O&&(O.style.display="none")}function R(){F();const t=F()?0:q(),o=e("#usageCounter");o&&(o.textContent=F()?"Pro: unlimited generations":`Free: ${Math.max(0,3-t)} of 3 left today`)}const U=["Book now","Grab your spot","Message us to claim","Call today","Learn more","Get a free quote","Schedule today"];function G(e){const t=[...U],o=[];for(e&&o.push(e);o.length<3&&t.length;){const e=Math.floor(Math.random()*t.length);o.push(t.splice(e,1)[0])}return Array.from(new Set(o)).slice(0,3)}window.addEventListener("DOMContentLoaded",(()=>{const t=e("#captionForm"),o=e("#results");e("#upgradeBtn")?.addEventListener("click",(()=>{window.location.href="https://buy.stripe.com/6oUaEY6oTaHBcd6drP0x203"})),e("#alreadyProBtn")?.addEventListener("click",(async()=>{const e=prompt("Enter the email you used to upgrade (temporary local unlock):");e&&/\S+@\S+\.\S+/.test(e)?(localStorage.setItem("dcc_pro_email",e),localStorage.setItem("dcc_pro","1"),z(),R(),alert("Pro unlocked on this browser.")):alert("That email doesnâ€™t look valid.")})),e("#closeModalBtn")?.addEventListener("click",z),window.addEventListener("click",(e=>{e.target===O&&z()})),o?.addEventListener("click",(e=>{const t=e.target.closest("button[data-copy]");t&&(!function(e){const t=document.getElementById(e);t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")}(t.getAttribute("data-copy")),t.textContent="Copied!",setTimeout((()=>t.textContent="Copy"),900))})),t?.addEventListener("submit",(t=>{if(t.preventDefault(),!F()&&q()>=3)return void(O&&(O.style.display="block"));const o=function(e){const t=G(e.cta),o=[];for(let s=0;s<3;s++){e.tone<=.3||e.tone;let a=`${e.offer||"Your offer here"} â€” for ${e.audience||"your ideal customers"}. We tackle ${e.problem||"the hard stuff"} so you get ${e.outcome||"better results"}. ${t[s]||"Learn more"}${e.cta?`: ${e.cta}`:""}`;o.push((n=a)?(n=(n=n.replace(/[.!?]{2,}/g,(e=>e[0]))).replace(/\s+([,.;!?])/g,"$1").replace(/([,.;!?])\1+/g,"$1")).trim().replace(/^([,.;!?]+)/,"").replace(/\s{2,}/g," "):"")}var n;return o}({offer:e("#offer")?.value?.trim(),platform:e("#platform")?.value,tone:parseFloat(e("#tone")?.value||"0.5"),audience:e("#audience")?.value?.trim(),problem:e("#problem")?.value?.trim(),outcome:e("#outcome")?.value?.trim(),cta:e("#cta")?.value?.trim(),keywords:e("#keywords")?.value?.trim(),format:e("#format")?.value,length:e("#captionLength")?.value||"Medium",voice:e("#voiceMode")?.value||"leadgen",cleanHashtags:e("#cleanHashtags")?.checked??!0});!function(t){const o=e("#results");o&&(o.innerHTML="",t.forEach(((e,t)=>{const n=`copy-${Date.now()}-${t}`;o.insertAdjacentHTML("beforeend",`\n      <article class="card">\n        <div class="card-body">\n          <p>${e}</p>\n          <button class="btn" data-copy="${n}" aria-label="Copy caption">Copy</button>\n        </div>\n        <textarea id="${n}" style="position:absolute;left:-9999px;opacity:0;">${e}</textarea>\n      </article>\n    `)})))}(o),F()||(W(),R())})),R()}));const J={_assemble(e){const{writerLine:t,variantIndex:o,profile:n,voiceMode:s,hook:a,whoNeed:r,offer:i,outcome:l,cta:c,tags:u,details:d,spacing:m,problem:h}=e,p=_(n,o,h,l,i,s);let g=[a?`${a}.`:"",t?`${t}`:"",r,p.benefit,p.result,c].filter(Boolean).join(m?"\n\n":" ");return u?`${g}\n\n${u}`:g},"facebook:post":e=>J._assemble(e),"facebook:story"({writerLine:e,profile:t,voiceMode:o,variantIndex:n,whoNeed:s,offer:a,outcome:r,cta:i}){const l=_(t,n,"",r,a,o);return`${e?e+"\n":""}${s.replace(/[.]+$/,"")}?\n${a}\n${l.result}\n${i}`},"facebook:reel"({writerLine:e,profile:t,voiceMode:o,variantIndex:n,hook:s,offer:a,outcome:r,cta:i,tags:l}){let c=`${s}\n${e?e+"\n":""}${a} â†’ ${_(t,n,"",r,a,o).result.replace(/^.*?:\s*/,"")}\n${i}`;return c=h(c,300),l?`${c}\n${l}`:c},"instagram:post"({writerLine:e,profile:t,voiceMode:o,variantIndex:n,hook:s,whoNeed:a,offer:r,outcome:i,cta:l,tags:c,details:u,problem:d}){const m=_(t,n,d,i,r,o);let p=(u?[s,e,a,`Weâ€™re handling it with ${r}.`,m.result,l]:[s,e,`${r} â†’ ${m.result.replace(/^.*?:\s*/,"")}`,l]).filter(Boolean).join("\n\n");return p=h(p,900),c?`${p}\n\n${c}`:p},"instagram:story"({writerLine:e,whoNeed:t,offer:o,cta:n}){let s=`${e?e+"\n":""}${t.replace(/[.]+$/,"")}?\n${o}\n${n}`;return h(s,220)},"instagram:reel"({writerLine:e,profile:t,voiceMode:o,variantIndex:n,hook:s,offer:a,outcome:r,cta:i,tags:l}){let c=`${s}\n${e?e+"\n":""}${a} â†’ ${_(t,n,"",r,a,o).result.replace(/^.*?:\s*/,"")}\n${i}`;return c=h(c,300),l?`${c}\n${l}`:c},"twitter:post"({writerLine:e,whoNeed:t,offer:o,outcome:n,cta:s,tags:a,profile:r,voiceMode:i,variantIndex:l}){let c=`${e?e+" ":""}${t} ${o} â†’ ${_(r,l,"",n,o,i).result.replace(/^.*?:\s*/,"")}. ${u=s,u.replace(/[.!\s]+$/g,"")}.`;var u;return c=h(c,280),a?`${c} ${a}`:c},"linkedin:profile":e=>J._assemble(e),"linkedin:page":e=>J._assemble(e),"gmb:post"({writerLine:e,whoNeed:t,offer:o,outcome:n,cta:s}){const a=n||"";return[`**${o}**`,"",`${e?e+"\n":""}${t}`,a?`\n${a}`:"",s,"","Call **270-388-3535** or visit **bluedobiedev.com/contact**"].join("\n")},"tiktok:video"({writerLine:e,whoNeed:t,offer:o,profile:n,voiceMode:s,variantIndex:a,outcome:r,cta:i,tags:l}){let c=`${e?e+"\n":""}${t}\n${o}\n${_(n,a,"",r,o,s).result}\n${i}`;return c=h(c,500),l?`${c}\n${l}`:c},"ytshorts:short"({writerLine:e,whoNeed:t,offer:o,profile:n,voiceMode:s,variantIndex:a,outcome:r,cta:i,tags:l}){let c=`${e?e+"\n":""}${t}\n${o} â†’ ${_(n,a,"",r,o,s).result.replace(/^.*?:\s*/,"")}\n${i}`;return c=h(c,300),l?`${c}\n${l}`:c},"youtube:video":({writerLine:e,whoNeed:t,offer:o,outcome:n,cta:s})=>`Title: ${h(`${o}: ${(n||t).replace(/^[A-Z]/,(e=>e.toLowerCase()))}`,100)}\n\nDescription:\n${["ã€ Speaker ã€‘",e||"â€”","","ã€ Who this is for ã€‘",`${t}`,"","ã€ What youâ€™ll learn ã€‘","â€¢ Why this matters",`â€¢ How ${o} solves it`,`â€¢ What changes: ${n||"less stress, better results"}`,"","ã€ Next step ã€‘",`${s}`,"","â€”","Bluedobie Developing â€¢ 270-388-3535 â€¢ bluedobiedev.com/contact"].join("\n")}`};t?.addEventListener("submit",(t=>{if(t.preventDefault(),!o)return;o.innerHTML="";const a=(e("#audience")?.value||"small business owners").trim(),r=function(e){let t=(e||"").trim();return t=t.replace(/\s+special$/i," special"),t}(e("#offer")?.value||"our $299 three-page website special"),i=function(e){let t=(e||"").replace(/\bin your box\b/gi,"in your inbox").trim();return t=d(t),m(t)}(e("#outcome")?.value||"more qualified leads in your inbox"),l=function(e){let t=(e||"").replace(/\bis\b/gi,"â€™s").replace(/\bour business\b/gi,"your business").trim();return t=t.replace(/^for\s+busy.*?,\s*/i,""),t=d(t),m(t)}(e("#problem")?.value||"customers canâ€™t find your business online"),c=(e("#cta")?.value||"Book your consultation this week.").trim(),u=(e("#keywords")?.value||"webdesign, marketing, bluedobiedev").trim(),k=(n?.value||"Facebook").trim().toLowerCase(),_=(s?.value||"Post").trim().toLowerCase(),E=parseFloat(e("#tone")?.value??"0.5"),M=(j=isNaN(E)?.5:E)<.33?{hookLead:["Quick win","Heads up","A small upgrade = a big payoff"],urgency:["Book now","Ready when you are","Letâ€™s get you visible"]}:j<.66?{hookLead:["Small change, big result","Level up your presence","Time to get found"],urgency:["Book this week","Grab a slot in the next 3 days","Letâ€™s start today"]}:{hookLead:["Your next move, now","Stop leaking time and leads","Visibility that pays for itself"],urgency:["Limited availabilityâ€”lock it in","Last call this week","Start now for the fastest impact"]};var j;const N=(e("#captionLength")?.value||"medium").toLowerCase(),A=(e("#hashtagDensity")?.value||"standard").toLowerCase(),D=e("#cleanHashtags")?.checked??!0,W=(e=>{const t=(e||"").match(b);return t?t[0]:null})(c),q=W?function(e,t,o){try{const n=/^https?:\/\//i.test(e)?e:`https://${e}`,s=new URL(n);return[...s.searchParams.keys()].some((e=>e.toLowerCase().startsWith("utm_")))||(s.searchParams.set("utm_source",(t||"").toLowerCase()),s.searchParams.set("utm_medium",(o||"post").toLowerCase()),s.searchParams.set("utm_campaign","captioncraft")),s.toString()}catch{return e}}(W,k,_):null,F=m((c||"").replace(v,"").trim()),O=q?`\n${q}`:"",{maxChars:z,details:R,spacing:U}=function(e,t,o){const n=(e||"").toLowerCase(),s=(t||"").toLowerCase(),a=(o||"").toLowerCase();return"twitter"===s?{maxChars:280,details:!1,spacing:!1}:"ytshorts"===s?{maxChars:300,details:!1,spacing:!1}:"tiktok"===s?{maxChars:500,details:!1,spacing:!1}:"youtube"===s?{maxChars:1200,details:!0,spacing:!0}:"story"===a?{maxChars:220,details:!1,spacing:!1}:"short"===n?{maxChars:180,details:!1,spacing:!1}:"long"===n?{maxChars:1100,details:!0,spacing:!0}:{maxChars:450,details:!0,spacing:!1}}(N,k,_),G=$(u,A,D,k,_),V=M.hookLead,Y=p(V),Q=function(e,t){const o=`${(e||"").toLowerCase()} ${(t||"").toLowerCase()}`;return/(fantasy|espn|commish|commissioner|league|sleeper|yahoo)/.test(o)?{persona:"fantasy_commissioners",voice:"casual",emojiBias:["ğŸˆ","ğŸ˜‚","ğŸ™ï¸","ğŸ“£"],needs:["save time","keep the league chat active","funny recaps"]}:/(contractor|plumber|hvac|electrician|roof|remodel)/.test(o)?{persona:"contractors",voice:"direct",emojiBias:["ğŸ› ï¸","ğŸ ","ğŸ“","â±ï¸"],needs:["book jobs","look legit locally","save admin time"]}:/(realtor|real estate|broker|agent)/.test(o)?{persona:"realtors",voice:"polished",emojiBias:["ğŸ¡","ğŸ“","ğŸ—ï¸","ğŸ“†"],needs:["book showings","grow referrals","post consistently"]}:/(restaurant|cafe|coffee|food|bakery)/.test(o)?{persona:"food_service",voice:"warm",emojiBias:["ğŸ”","â˜•","ğŸ¥—","ğŸ“¸"],needs:["foot traffic","repeat visits","local visibility"]}:{persona:"general_smallbiz",voice:"friendly",emojiBias:["ğŸ“Œ","ğŸ¤","ğŸ“ˆ","ğŸ§­"],needs:["save time","post consistently","sound human"]}}(a,u),K=function(e,t,o){const n=(e||"").toLowerCase(),s=(t||"").toLowerCase();return/time|busy|no time|save time|faster/.test(n+s)?"save time":/engage|chat|banter|conversation|quiet|silent|crickets/.test(n+s)?"keep the conversation going":/leads|book|sales|call|inbox/.test(n+s)?"get more inquiries":/consistent|presence|on-brand|look/.test(n+s)?"stay consistent without sounding robotic":o.needs[0]||"get results faster"}(l,i,Q),Z=function(e,t,o){const n=(e||"your audience").trim();switch(o.persona){case"fantasy_commissioners":return`${n} need to ${t} (and keep the league chat alive).`;case"contractors":return`${n} need to ${t} and look legit locally.`;case"realtors":return`${n} need to ${t} and show up consistently.`;case"food_service":return`${n} need to ${t} and bring people in the door.`;default:return`${n} need to ${t}.`}}(a,K,Q),X=function(e,t){const o=document.getElementById("voiceMode")?.value;return o||("fantasy_commissioners"===e.persona?"community":"linkedin"===(t||"").toLowerCase()?"authority":"leadgen")}(Q,k),ee=function(e,t,o){const n=(e+" "+t+" "+o).toLowerCase();return/fantasy|espn|sleeper|yahoo|commissioner|commish|league/.test(n)?{domain:"fantasy",pains:["no time to write weekly recaps","Sunday-night scramble to sound witty","league chat going quiet by mid-season"],benefits_time:["you get your Sunday night back","skip the scrambleâ€”recaps arrive done","automation handles the recap grind"],benefits_social:["your group chat stays loud past Week 6","friends keep the trash talk going","the league actually reads the recaps"],benefits_status:["you look like an MVP commissioner","your league treats you like a pro","everyone thinks you hired a writer"],result_verbs:["Result","Outcome","Bottom line"]}:{domain:"generic",pains:["hard to keep up with posts","content takes too long to write","ideas run out mid-week"],benefits_time:["you get hours back each week","no more blank-page panic","posts are ready when you are"],benefits_social:["your audience actually engages","comments donâ€™t fizzle out","more saves and shares"],benefits_status:["you look consistent and on-brand","you sound like a real person","you ship content without stress"],result_verbs:["Result","Outcome","Bottom line"]}}(a,u,r),te=function(){const e=P(),t=T();return e.some((e=>e.id===t))?t:e[0]?.id||"brand"}(),oe=function(e,t){const o=(t||"your audience").toString().trim();return"owner"===e?`As a fellow ${o}, I get it:`:"mascot"===e?`${H()||"your mascot"} here â€” quick reality check:`:"At Bluedobie, we get it."}(te,a),ne=function({offer:e,problem:t,outcome:o,cta:n}){const s=[];return(!e||e.length<2)&&s.push("Offer looks empty/too short."),(!t||t.length<3)&&s.push("Problem looks empty/too short."),(!o||o.length<3)&&s.push("Outcome looks empty/too short."),(!n||n.length<2)&&s.push("CTA looks empty/too short."),s}({offer:r,problem:l,outcome:i,cta:F});if(ne.length){const e=document.createElement("div");e.className="card",e.style.margin="12px 0",e.style.background="#fff7ed",e.style.borderColor="#fdba74",e.innerHTML=`<strong>Heads up:</strong> ${ne.join(" ")} Weâ€™ll auto-fix obvious fragments.`,o.appendChild(e)}let se=function(e,t,o){const n=`${t}:${o}`.toLowerCase(),s=J[n]||J["facebook:post"],a=[];for(let t=0;t<3;t++){const o={...e,variantIndex:t};a.push(s(o)),e.hook=p(e.hookPool)}return a}({hook:Y,hookPool:V,audience:a,problem:l,offer:r,outcome:i,cta:F,tags:G,details:R,spacing:U,intent:Q,need:K,whoNeed:Z,profile:ee,voiceMode:X,writerId:te,writerLine:oe},k,_).map((e=>{let t=e;q&&!["gmb","youtube"].includes(k)&&"story"!==_&&(t=t.length+("\n"+q).length<=z?`${t}${O}`:t);let o={out:t,changed:!1};"youtube"!==k&&(o=function(e){const t=e;let o=!1,n=e.split(/\n+/).map(w).filter((e=>e.length));const s=[];for(let e=0;e<n.length;e++){let t=n[e];if(C(t)){const s=n[e+1];!s||f(s)||y(s)||(t=(t+" "+s).replace(/\s{2,}/g," ").trim(),e+=1,o=!0)}f(t)||g(t)||y(t)||/[.!?]$/.test(t)||(t+="."),s.push(t)}const a=s.join("\n");return{out:a,changed:o||a!==t}}(t));const n="youtube"===k?1200:z;return o.out=h(o.out,n),o}));const ae=function(e,t,o,n){const s=(e||"").toLowerCase();if("instagram"===s){const e=[];return n&&e.push(`ğŸ”— ${n}`),o&&e.push(o),e.join("\n")}if("linkedin"===s){const e=[];return n&&e.push(`Quick link: ${n}`),e.push("Questions? Drop a comment and Iâ€™ll reply."),e.join("\n")}return""}(k,0,G,q),re=se.flatMap((e=>S(e.out))).filter((e=>L.includes(e))),ie=re.length>=3;se.forEach(((e,t)=>{let n=e.out;const s=e.changed,r=B(n),i=(I(u,a,k),r.looksAIish||ie),l=document.createElement("div");l.className="caption-card";const c=`${k.toUpperCase()} â€¢ ${_.toUpperCase()} â€¢ ${X.toUpperCase()}`,d=function(e,t){return{"facebook:post":"Best: 9â€“11am or 1â€“3pm â€¢ 1â€“3 short paragraphs â€¢ 4â€“7 hashtags","facebook:story":"Best: mornings/evenings â€¢ 2â€“3 lines â€¢ link sticker","facebook:reel":"Best: afternoons â€¢ hook + 1â€“2 lines â€¢ 3â€“5 hashtags","instagram:post":"Best: late morning â€¢ hook + 2â€“3 lines â€¢ 5â€“9 hashtags","instagram:story":"Best: when active â€¢ 1â€“2 lines â€¢ link sticker","instagram:reel":"Best: evenings â€¢ hook + benefit + CTA â€¢ 3â€“7 hashtags","twitter:post":"Best: commute hours â€¢ keep <280 â€¢ â‰¤2 hashtags","linkedin:profile":"Best: Tueâ€“Thu mornings â€¢ 3â€“6 lines â€¢ â‰¤3 hashtags","linkedin:page":"Best: business hours â€¢ brand tone â€¢ â‰¤3 hashtags","gmb:post":"Best: business hours â€¢ plain language â€¢ no hashtags","tiktok:video":"Best: evenings/weekends â€¢ 3â€“4 lines â€¢ 6â€“10 hashtags","ytshorts:short":"Best: evenings â€¢ 2â€“3 lines â€¢ 3â€“5 hashtags","youtube:video":"Best: consistent weekly slot â€¢ title + description â€¢ no hashtag soup"}[`${e}:${t}`.toLowerCase()]||""}(k,_),m=i?'<div class="hint" style="color:#b45309;">âš ï¸ Emoji pattern looks AI-ish (generic or front-loaded). Try â€œHumanize emojisâ€.</div>':"",h=ae?`\n        <div class="first-comment">\n          <div class="muted" style="margin:6px 0 4px;">First comment (for reach):</div>\n          <textarea readonly>${ae}</textarea>\n          <div class="row">\n            <button type="button" class="copy-first-btn">Copy first comment</button>\n            <span class="meta">Optional</span>\n          </div>\n        </div>`:"",g=s?'<span class="meta" style="color:#b45309;">Auto-fixed formatting</span>':"";l.innerHTML=`\n        <h3>Caption ${t+1}</h3>\n        <textarea readonly>${n}</textarea>\n        <div class="row" style="gap:8px; flex-wrap:wrap;">\n          <button type="button" class="copy-btn">Copy</button>\n          <button type="button" class="emoji-btn" title="Swap generic emojis, randomize placement">Humanize emojis</button>\n          <span class="meta">${c}</span>\n        </div>\n        <div class="hint muted">${d}</div>\n        ${g?`<div class="hint">${g}</div>`:""}\n        ${m}\n        ${h}\n      `,o.appendChild(l);const b=l.querySelector(".copy-btn"),v=l.querySelector(".emoji-btn"),$=l.querySelector("textarea");b?.addEventListener("click",(()=>{$.select(),document.execCommand("copy"),b.textContent="Copied!",setTimeout((()=>b.textContent="Copy"),1500)})),v?.addEventListener("click",(()=>{const e=function(e,t,o){const n=["tiktok","instagram"].includes((o||"").toLowerCase())?2:1;return e.split(/\n/).map((e=>{const o=e.trim();if(!o||f(o)||y(o))return e;let s=o.replace(x,(e=>L.includes(e)?p(t):e));if(S(s).length>n){let e=0;s=s.replace(x,(t=>e++<n?t:"")).replace(/\s{2,}/g," ").trim()}if(0===S(s).length&&Math.random()<.6){const e=p(t),o=s.split(" "),n=Math.max(1,Math.min(o.length-1,Math.floor(o.length/2)));o.splice(n,0,e),s=o.join(" ")}return s})).join("\n")}($.value,I(u,a,k),k);$.value=e,v.textContent="Emojis humanized",setTimeout((()=>v.textContent="Humanize emojis"),1800)}));const w=l.querySelector(".copy-first-btn");w&&w.addEventListener("click",(()=>{l.querySelector(".first-comment textarea").select(),document.execCommand("copy"),w.textContent="Copied!",setTimeout((()=>w.textContent="Copy first comment"),1500)}))}))})),r?.addEventListener("click",(()=>{["audience","offer","outcome","problem","cta","keywords"].forEach((e=>{const t=document.getElementById(e);t&&(t.value="")}));const e=document.getElementById("captionLength");e&&(e.value="Medium");const t=document.getElementById("hashtagDensity");t&&(t.value="Standard");const n=document.getElementById("cleanHashtags");n&&(n.checked=!0);const s=document.getElementById("tone");s&&(s.value=.5),o.innerHTML=""}))}));