// @ts-nocheck
document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("poll-form"),t=document.getElementById("poll-results"),o="http://127.0.0.1:5000";async function i(){try{const e=await fetch(`${o}/votes`);if(!e.ok)throw new Error(`Failed to fetch votes: ${e.statusText}`);return await e.json()}catch(e){return console.error("Error fetching votes:",e),alert("Failed to load poll results. Please check your network or contact support."),{speed:0,design:0,visibility:0}}}function n(e){const t=e.speed+e.design+e.visibility;if(0===t)return void console.log("No votes yet.");const o={speed:e.speed/t*100,design:e.design/t*100,visibility:e.visibility/t*100},i=Math.max(o.speed,o.design,o.visibility),n={speed:document.getElementById("speed-bar"),design:document.getElementById("design-bar"),visibility:document.getElementById("visibility-bar")},s={speed:document.getElementById("speed-percentage"),design:document.getElementById("design-percentage"),visibility:document.getElementById("visibility-percentage")};Object.keys(n).forEach((e=>{n[e].style.width=`${o[e].toFixed(2)}%`,n[e].style.backgroundColor=o[e]===i?"#4caf50":"#f44336",s[e].textContent=`${o[e].toFixed(2)}%`}))}e.addEventListener("submit",(async function(t){t.preventDefault();const s=new FormData(e).get("vote");if(s){console.log("Submitting vote for:",s),await async function(e){try{const t=await fetch(`${o}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({option:e})});if(!t.ok)throw new Error(`Failed to submit vote: ${t.statusText}`);console.log("Vote submitted successfully")}catch(e){console.error("Error submitting vote:",e),e.message.includes("CORS")?alert("CORS policy error. Please ensure your backend is configured to accept requests from this origin."):alert("An error occurred while submitting your vote. Please try again later.")}}(s),e.style.display="none";n(await i())}else alert("Please select an option before voting.")})),async function(){n(await i()),t.style.display="block"}()}));